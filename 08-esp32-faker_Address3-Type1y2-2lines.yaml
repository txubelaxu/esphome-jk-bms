<<: !include 08-esp32.yaml

interval:
  - interval: 20s
    then:
      - lambda: |-
          const uint8_t settings_frame[308] = {0x55 ,0xAA ,0xEB ,0x90 ,0x01 ,0x05 ,0xD5 ,0x0C ,0x00 ,0x00 ,0x28 ,0x0A ,0x00 ,0x00 ,0x5A ,0x0A ,0x00 ,0x00 ,0x42 ,0x0E ,0x00 ,0x00 ,0x5B ,0x0D ,0x00 ,0x00 ,0x07 ,0x00 ,0x00 ,0x00 ,0x61 ,0x0D ,0x00 ,0x00 ,0x50 ,0x0A ,0x00 ,0x00 ,0x6D ,0x0D ,0x00 ,0x00 ,0x66 ,0x0D ,0x00 ,0x00 ,0xC4 ,0x09 ,0x00 ,0x00 ,0x40 ,0x0D ,0x03 ,0x00 ,0x03 ,0x00 ,0x00 ,0x00 ,0x3C ,0x00 ,0x00 ,0x00 ,0x40 ,0x0D ,0x03 ,0x00 ,0x2C ,0x01 ,0x00 ,0x00 ,0x3C ,0x00 ,0x00 ,0x00 ,0x05 ,0x00 ,0x00 ,0x00 ,0xD0 ,0x07 ,0x00 ,0x00 ,0xBC ,0x02 ,0x00 ,0x00 ,0x58 ,0x02 ,0x00 ,0x00 ,0xBC ,0x02 ,0x00 ,0x00 ,0x58 ,0x02 ,0x00 ,0x00 ,0x38 ,0xFF ,0xFF ,0xFF ,0x9C ,0xFF ,0xFF ,0xFF ,0xE8 ,0x03 ,0x00 ,0x00 ,0x20 ,0x03 ,0x00 ,0x00 ,0x10 ,0x00 ,0x00 ,0x00 ,0x01 ,0x00 ,0x00 ,0x00 ,0x01 ,0x00 ,0x00 ,0x00 ,0x01 ,0x00 ,0x00 ,0x00 ,0x90 ,0xCA ,0x04 ,0x00 ,0xDC ,0x05 ,0x00 ,0x00 ,0x52 ,0x0D ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x03 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x60 ,0xE3 ,0x16 ,0x00 ,0x00 ,0x00 ,0x3C ,0x32 ,0x18 ,0xFE ,0xFF ,0xFF ,0xFF ,0x9F ,0xE9 ,0x1D ,0x02 ,0x00 ,0x00 ,0x00 ,0x00 ,0x9D ,0x03 ,0x10 ,0x16 ,0x1E ,0x00 ,0x01 ,0x64 ,0x65};

          // Convierte el array C a std::vector<uint8_t>
          std::vector<uint8_t> simulated_bms_frame_vector_settings_frame(
              settings_frame,
              settings_frame + sizeof(settings_frame)
          );

          // Valores de ejemplo para los nuevos par치metros
          const uint8_t origin_address = 0x03; // O el que corresponda a tu simulaci칩n
          #//const uint8_t frame_type_1 = 0x01;     // 0x01 => settings_frame 
          const uint8_t frame_type = settings_frame[4];
          const std::string nodes_info = "simulated_node"; // O cualquier string descriptivo

          id(bms2).on_jk_rs485_sniffer_data(origin_address, frame_type, simulated_bms_frame_vector_settings_frame, nodes_info);

      - delay: 2s

      - lambda: |-
          const uint8_t cell_info_frame[308] = {0x55 ,0xAA ,0xEB ,0x90 ,0x02 ,0x05 ,0x00 ,0x0D ,0x00 ,0x0D ,0x00 ,0x0D ,0x01 ,0x0D ,0x01 ,0x0D ,0x01 ,0x0D ,0x02 ,0x0D ,0x01 ,0x0D ,0x00 ,0x0D ,0x00 ,0x0D ,0x00 ,0x0D ,0x00 ,0x0D ,0x00 ,0x0D ,0x00 ,0x0D ,0x01 ,0x0D ,0x00 ,0x0D ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0xFF ,0xFF ,0x00 ,0x00 ,0x00 ,0x0D ,0x03 ,0x00 ,0x03 ,0x00 ,0x41 ,0x00 ,0x3D ,0x00 ,0x41 ,0x00 ,0x3C ,0x00 ,0x40 ,0x00 ,0x3D ,0x00 ,0x3F ,0x00 ,0x3C ,0x00 ,0x41 ,0x00 ,0x3E ,0x00 ,0x41 ,0x00 ,0x3E ,0x00 ,0x41 ,0x00 ,0x3F ,0x00 ,0x41 ,0x00 ,0x3F ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x0C ,0x01 ,0x00 ,0x00 ,0x00 ,0x00 ,0xFF ,0xCF ,0x00 ,0x00 ,0xAD ,0x61 ,0x03 ,0x00 ,0x42 ,0x10 ,0x00 ,0x00 ,0x10 ,0x01 ,0x0A ,0x01 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x55 ,0xB4 ,0x11 ,0x04 ,0x00 ,0x90 ,0xCA ,0x04 ,0x00 ,0x16 ,0x00 ,0x00 ,0x00 ,0xA2 ,0x20 ,0x6B ,0x00 ,0x64 ,0x00 ,0x00 ,0x00 ,0xEE ,0x58 ,0x52 ,0x00 ,0x01 ,0x01 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0xFF ,0x00 ,0x01 ,0x00 ,0x00 ,0x00 ,0xB2 ,0x03 ,0x0B ,0x00 ,0x00 ,0x00 ,0x7B ,0x86 ,0x3F ,0x40 ,0x00 ,0x00 ,0x00 ,0x00 ,0xCC ,0x14 ,0x00 ,0x00 ,0x00 ,0x01 ,0x01 ,0x01 ,0x00 ,0x06 ,0x00 ,0x00 ,0x59 ,0xC9 ,0xF0 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x0C ,0x01 ,0x07 ,0x01 ,0x0C ,0x01 ,0xB2 ,0x03 ,0x97 ,0x2C ,0x46 ,0x0A ,0x12 ,0x00 ,0x00 ,0x00 ,0x80 ,0x51 ,0x01 ,0x00 ,0x00 ,0x00 ,0x00 ,0x02 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0xFE ,0xFF ,0x7F ,0xDC ,0x2F ,0x01 ,0x01 ,0xB0 ,0x0F ,0x00 ,0x00 ,0x00 ,0xC4 ,0x03 ,0x10 ,0x16 ,0x20 ,0x00 ,0x01 ,0x05 ,0xA9};

          // Convierte el array C a std::vector<uint8_t>
          std::vector<uint8_t> simulated_bms_frame_vector_cell_info_frame(
              cell_info_frame,
              cell_info_frame + sizeof(cell_info_frame)
          );

          // Valores de ejemplo para los nuevos par치metros
          const uint8_t origin_address_2 = 0x03; // O el que corresponda a tu simulaci칩n

          # //const uint8_t frame_type_2 = 0x02;     // 0x02 => cell_info_frame
          const uint8_t frame_type = cell_info_frame[4];
          const std::string nodes_info = "simulated_node"; // O cualquier string descriptivo

          id(bms2).on_jk_rs485_sniffer_data(origin_address_2, frame_type, simulated_bms_frame_vector_cell_info_frame, nodes_info);

      - delay: 2s
